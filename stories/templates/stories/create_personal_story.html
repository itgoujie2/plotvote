{% extends 'base.html' %}

{% block title %}Create Personal Story - PlotVote{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <a href="{% url 'stories:my_stories' %}" class="text-indigo-600 hover:text-indigo-700 font-medium mb-4 inline-block">
        â† Back to My Stories
    </a>

    <div class="bg-white rounded-lg shadow-sm p-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Create Personal Story</h1>
        <p class="text-gray-600 mb-6">Start a new story that you can write chapter by chapter using AI</p>

        <!-- Quick Start Guide -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
            <button
                type="button"
                onclick="toggleGuide()"
                class="w-full flex items-center justify-between mb-4"
            >
                <h3 class="font-semibold text-blue-900 flex items-center gap-2">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                    </svg>
                    Quick Start Guide - See Complete Example
                </h3>
                <svg id="guide-chevron" class="w-5 h-5 text-blue-700 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </button>

            <div id="guide-section" class="hidden">
                <p class="text-sm text-blue-900 mb-4">
                    Not sure where to start? Here are two complete examples of well-structured stories:
                </p>

                <!-- Language Tabs -->
                <div class="flex gap-2 mb-4">
                    <button
                        type="button"
                        onclick="switchExample('english')"
                        id="tab-english"
                        class="px-4 py-2 rounded-lg font-medium bg-white text-blue-800 border-2 border-blue-800"
                    >
                        English Example (Sci-Fi)
                    </button>
                    <button
                        type="button"
                        onclick="switchExample('chinese')"
                        id="tab-chinese"
                        class="px-4 py-2 rounded-lg font-medium bg-blue-100 text-blue-700 border-2 border-transparent hover:bg-blue-200"
                    >
                        ä¸­æ–‡ç¤ºä¾‹ (ç„å¹»)
                    </button>
                </div>

                <!-- English Example -->
                <div id="example-english" class="bg-white rounded-lg p-4 space-y-4 text-sm">
                    <!-- Basic Fields -->
                    <div class="pb-4 border-b border-gray-200">
                        <div class="mb-3">
                            <span class="font-semibold text-gray-900">Title:</span>
                            <span class="text-gray-700"> "The Last Signal from Europa"</span>
                        </div>
                        <div class="mb-3">
                            <span class="font-semibold text-gray-900">Story Premise:</span>
                            <p class="text-gray-700 mt-1">
                                "Dr. Sarah Chen receives an encrypted distress signal from the Europa Research Stationâ€”a facility she helped design five years ago. The station has been silent for three months, and the signal contains her biometric signature. As she decodes the message, she discovers it's not a cry for help, but a warning: 'Don't send anyone. Don't come looking. I'm already dead.' The problem? The message was sent yesterday, and Sarah has been on Earth the entire time."
                            </p>
                        </div>
                        <div>
                            <span class="font-semibold text-gray-900">Genre:</span>
                            <span class="text-gray-700"> Science Fiction</span>
                            <span class="mx-2">â€¢</span>
                            <span class="font-semibold text-gray-900">Language:</span>
                            <span class="text-gray-700"> English</span>
                            <span class="mx-2">â€¢</span>
                            <span class="font-semibold text-gray-900">Chapters:</span>
                            <span class="text-gray-700"> 10</span>
                        </div>
                    </div>

                    <!-- Story Framework Examples -->
                    <div class="space-y-4">
                        <h4 class="font-semibold text-gray-900">Story Framework (Optional but Recommended):</h4>

                        <!-- Characters -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">Main Characters:</span>
                                <button type="button" onclick="copyToClipboard('characters-example')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    Copy
                                </button>
                            </div>
                            <pre id="characters-example" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">Dr. Sarah Chen (Protagonist)
- 42-year-old astrobiologist, former Europa mission lead
- Brilliant but haunted by the loss of her research team
- Analytical, determined, uses dark humor as coping mechanism

Dr. James Rivera (Ally/Deuteragonist)
- 38-year-old quantum communications specialist
- Was Sarah's closest friend on the Europa mission
- Skeptical but loyal, provides technical expertise

Commander Elena Volkov (Authority Figure)
- 55-year-old director of International Space Research Facility
- Former cosmonaut, no-nonsense leadership style
- Maternal figure who mentored Sarah</pre>
                        </div>

                        <!-- Story Outline -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">Story Outline:</span>
                                <button type="button" onclick="copyToClipboard('outline-example')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    Copy
                                </button>
                            </div>
                            <pre id="outline-example" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">Act 1 - The Mystery (Chapters 1-3):
- Sarah receives impossible signal from Europa
- Working with James and Elena, discovers signal is from herself
- Flashbacks reveal the Europa mission and alien intelligence discovery
- Marcus Reeves (Helios Corp) arrives with hidden agenda

Act 2 - The Truth (Chapters 4-7):
- Sarah infiltrates Iceland facility, discovers consciousness transfer tech
- Realizes she's a "copy" with implanted memories
- Finds James and Yukiâ€”they're copies too
- Team confronts truth: originals still on Europa, merged with alien intelligence

Act 3 - The Choice (Chapters 8-10):
- Full message decoded: originals offering choice to integrate memories
- Marcus captures team, forcing Sarah to choose
- Sarah integrates memories, accepting dual existence
- Final confrontation: expose Helios, return consciousness to Europa
- Resolution: Sarah becomes bridge between humanity and alien intelligence</pre>
                        </div>

                        <!-- World Building -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">World Building:</span>
                                <button type="button" onclick="copyToClipboard('worldbuilding-example')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    Copy
                                </button>
                            </div>
                            <pre id="worldbuilding-example" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">Time Period: 2089 (Near future)

Technology:
- Quantum communication enables near-instant messaging
- Consciousness can be digitized and transmitted as data
- Neural mapping allows perfect replication of consciousness

Key Locations:
- International Space Research Facility (Iceland)
- Europa Research Station (underwater, beneath ice shell)
- Helios Corporation Secret Facility (hidden in glacier)

Rules of Consciousness Transfer:
- Consciousness can be copied, creating identical duplicates
- Copies have all memories up to mapping point
- Original and copy are separate entities
- Substrate doesn't matter - consciousness is transferable</pre>
                        </div>

                        <!-- Themes -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">Themes & Tone:</span>
                                <button type="button" onclick="copyToClipboard('themes-example')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    Copy
                                </button>
                            </div>
                            <pre id="themes-example" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">Primary Themes:
- Identity and consciousness: What makes you "you"?
- The price of scientific discovery
- Corporate greed vs. scientific integrity
- Grief and acceptance

Tone:
- Tense and mysterious with building dread
- Moments of cosmic horror
- Emotional depth in character relationships
- Philosophical without being preachy
- Hopeful despite dark themes</pre>
                        </div>

                        <!-- Writing Style -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">Writing Style:</span>
                                <button type="button" onclick="copyToClipboard('style-example')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    Copy
                                </button>
                            </div>
                            <pre id="style-example" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">Narrative Perspective:
- Third person limited, primarily from Sarah's POV
- Occasional shifts to James or Yuki for specific scenes

Pacing:
- Hook readers immediately with mystery in Chapter 1
- Alternate between present investigation and past events
- Each chapter ends with hook or revelation
- 800-1200 words per chapter

Tone Guidelines:
- Sarah uses dark humor to deflect emotions
- Technical jargon should feel natural, not forced
- Balance action, investigation, and character moments</pre>
                        </div>
                    </div>
                </div>

                    <div class="mt-4 pt-4 border-t border-gray-200 flex items-center justify-between gap-4">
                        <p class="text-sm text-blue-900 flex-1">
                            <strong>ğŸ’¡ Tip:</strong> Copy any section above and paste into the corresponding field below!
                        </p>
                        <a href="/story/the-last-signal-from-europa/" target="_blank" class="text-sm bg-blue-100 hover:bg-blue-200 text-blue-800 font-medium px-4 py-2 rounded-lg transition whitespace-nowrap">
                            View Finished Story â†’
                        </a>
                    </div>
                </div>

                <!-- Chinese Example -->
                <div id="example-chinese" class="bg-white rounded-lg p-4 space-y-4 text-sm hidden">
                    <!-- Basic Fields -->
                    <div class="pb-4 border-b border-gray-200">
                        <div class="mb-3">
                            <span class="font-semibold text-gray-900">æ ‡é¢˜ (Title):</span>
                            <span class="text-gray-700"> "é­”å°Šé‡ç”Ÿ"</span>
                        </div>
                        <div class="mb-3">
                            <span class="font-semibold text-gray-900">æ•…äº‹ç®€ä»‹ (Story Premise):</span>
                            <p class="text-gray-700 mt-1">
                                "æ—ç¾½ï¼Œå¤©ç„å®—å…¬è®¤çš„åºŸæå¼Ÿå­ï¼Œçµæ ¹ç ´ç¢ï¼Œä¿®ä¸ºåœæ»åœ¨ç‚¼æ°”æœŸä¸‰å¹´ã€‚åœ¨ä¸€æ¬¡å®—é—¨è¯•ç‚¼ä¸­ï¼Œä»–æ„å¤–è·Œå…¥ç¦åœ°æ·±æ¸Šï¼Œæœ¬ä»¥ä¸ºå¿…æ­»æ— ç–‘ï¼Œå´åœ¨ç”Ÿæ­»å…³å¤´è§‰é†’äº†å‰ä¸–è®°å¿†â€”â€”ä»–ç«Ÿæ˜¯ä¸‰åƒå¹´å‰æ¨ªæ‰«ä¿®çœŸç•Œçš„é­”å°Šè¡€ç…ã€‚ä½†é‡ç”Ÿåçš„ä»–çµæ ¹å°½æ¯ï¼Œåªèƒ½ä»å¤´å¼€å§‹ã€‚æ›´è¯¡å¼‚çš„æ˜¯ï¼Œåœ¨ç¦åœ°æ·±å¤„ï¼Œä»–å‘ç°äº†ä¸€ä¸ªè¢«å°å°çš„å¥³å­ã€‚å¥¹æµ‘èº«é­”æ°”ç¼­ç»•ï¼Œæ­£æ˜¯å½“ä»Šä¿®çœŸç•Œäººäººå–Šæ‰“çš„é­”æ•™æ•™ä¸»â€”â€”å¸å¾’å¯’æœˆã€‚æ—ç¾½æœ¬æƒ³ç¦»å¼€ï¼Œå´è¢«å¸å¾’å¯’æœˆä¸€çœ¼çœ‹ç©¿äº†å‰ä¸–èº«ä»½ã€‚é¢å¯¹å¥„å¥„ä¸€æ¯çš„å¸å¾’å¯’æœˆï¼Œæ—ç¾½çŠ¹è±«äº†ã€‚æ•‘å¥¹ï¼Œæ„å‘³ç€ä¸æ•´ä¸ªæ­£é“ä¸ºæ•Œï¼›ä¸æ•‘ï¼Œå¥¹æ‰‹ä¸­çš„ã€Šä¹å¹½é­”å…¸ã€‹å°±ä¼šéšå¥¹è€Œå»ï¼Œè€Œé‚£æ­£æ˜¯ä»–æ¢å¤ä¿®ä¸ºçš„å”¯ä¸€å¸Œæœ›ã€‚æœ€ç»ˆï¼Œæ—ç¾½é€‰æ‹©æ•‘ä¸‹äº†å¥¹ã€‚å´ä¸çŸ¥ï¼Œè¿™ä¸ªå†³å®šå°†å½»åº•æ”¹å˜ä»–çš„å‘½è¿â€”â€”å¸å¾’å¯’æœˆä¸ä»…æ˜¯é­”æ•™æ•™ä¸»ï¼Œæ›´æ˜¯å°å°ä»–å‰ä¸–é­”å°Šä¹‹åŠ›çš„å…³é”®ã€‚è€Œé‚£åœºä¸‰åƒå¹´å‰çš„æ­£é­”å¤§æˆ˜ï¼ŒèƒŒåéšè—ç€æ¯”ä»–è®°å¿†ä¸­æ›´æ·±çš„ç§˜å¯†..."
                            </p>
                        </div>
                        <div>
                            <span class="font-semibold text-gray-900">ç±»å‹ (Genre):</span>
                            <span class="text-gray-700"> ç„å¹» (Fantasy/Other)</span>
                            <span class="mx-2">â€¢</span>
                            <span class="font-semibold text-gray-900">è¯­è¨€ (Language):</span>
                            <span class="text-gray-700"> ä¸­æ–‡ (Chinese)</span>
                            <span class="mx-2">â€¢</span>
                            <span class="font-semibold text-gray-900">è®¡åˆ’ç« èŠ‚ (Chapters):</span>
                            <span class="text-gray-700"> 30</span>
                        </div>
                    </div>

                    <!-- Story Framework Examples -->
                    <div class="space-y-4">
                        <h4 class="font-semibold text-gray-900">æ•…äº‹æ¡†æ¶ (Story Framework - Optional but Recommended):</h4>

                        <!-- Characters -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">ä¸»è¦äººç‰© (Main Characters):</span>
                                <button type="button" onclick="copyToClipboard('characters-example-cn')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    å¤åˆ¶ (Copy)
                                </button>
                            </div>
                            <pre id="characters-example-cn" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">æ—ç¾½ï¼ˆä¸»è§’ï¼‰
- 18å²ï¼Œå¤©ç„å®—å¤–é—¨å¼Ÿå­
- è¡¨é¢ï¼šçµæ ¹ç ´ç¢çš„åºŸæï¼Œè¢«åŒé—¨æ¬ºå‡Œ
- çœŸå®èº«ä»½ï¼šä¸‰åƒå¹´å‰è¡€ç…é­”å°Šè½¬ä¸–ï¼Œè®°å¿†è§‰é†’
- æ€§æ ¼ï¼šå¤–è¡¨æ‡¦å¼±ï¼Œå†…å¿ƒåšéŸ§æœæ–­ï¼›å‰ä¸–æ€ä¼æœæ–­ï¼Œä»Šç”Ÿå¤šäº†å‡ åˆ†äººæ€§
- ç›®æ ‡ï¼šæ¢å¤ä¿®ä¸ºï¼ŒæŸ¥æ˜å‰ä¸–è¢«å›´å‰¿çš„çœŸç›¸

å¸å¾’å¯’æœˆï¼ˆå¥³ä¸»ï¼‰
- 26å²ï¼Œå¹½å†¥é­”æ•™ç°ä»»æ•™ä¸»
- ä¿®ä¸ºï¼šå…ƒå©´åæœŸï¼ˆå—ä¼¤è·Œè½è‡³é‡‘ä¸¹æœŸï¼‰
- å®¹è²Œï¼šç»ä¸–å€¾åŸï¼Œä¸€è¢­é»‘è¡£ï¼Œæ°”è´¨å†·è‰³
- æ€§æ ¼ï¼šå†·é…·æ— æƒ…ï¼Œå´å¯¹æ—ç¾½å‰ä¸–æœ‰ç€å¤æ‚æƒ…æ„Ÿ
- ç§˜å¯†ï¼šå¥¹æ˜¯å°å°è¡€ç…é­”å°Šçš„å…³é”®ï¼Œä½“å†…æœ‰é­”å°Šä¸€åŠçš„åŠ›é‡

è‹æ¸…æ­Œ
- 17å²ï¼Œå¤©ç„å®—å¤©æ‰å¼Ÿå­ï¼Œé‡‘ä¸¹åˆæœŸ
- å¤©çµæ ¹ï¼Œå®—é—¨é‡ç‚¹åŸ¹å…»å¯¹è±¡
- æ€§æ ¼ï¼šè¡¨é¢æ¸©æŸ”å–„è‰¯ï¼Œå†…å¿ƒé«˜å‚²ï¼Œç§ä¸èµ·åºŸæå¼Ÿå­
- ä¸æ—ç¾½ï¼šæ›¾ç»çš„é’æ¢…ç«¹é©¬ï¼Œæ—ç¾½çµæ ¹ç ´ç¢åç–è¿œ</pre>
                        </div>

                        <!-- Story Outline -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">æ•…äº‹å¤§çº² (Story Outline):</span>
                                <button type="button" onclick="copyToClipboard('outline-example-cn')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    å¤åˆ¶ (Copy)
                                </button>
                            </div>
                            <pre id="outline-example-cn" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">ç¬¬ä¸€å¹• - è§‰é†’ï¼ˆ1-5ç« ï¼‰
- æ—ç¾½åœ¨å®—é—¨è¯•ç‚¼ä¸­è¢«é™·å®³ï¼Œè·Œå…¥ç¦åœ°
- ç”Ÿæ­»å…³å¤´è§‰é†’å‰ä¸–è®°å¿†ï¼Œå‘ç°è‡ªå·±æ˜¯è¡€ç…é­”å°Šè½¬ä¸–
- é‡åˆ°è¢«å°å°çš„å¸å¾’å¯’æœˆï¼Œç»è¿‡å†…å¿ƒæŒ£æ‰åé€‰æ‹©æ•‘å¥¹
- å¸å¾’å¯’æœˆè®¤å‡ºæ—ç¾½å‰ä¸–èº«ä»½ï¼Œä½†è£…ä½œä¸çŸ¥
- ä¸¤äººè¾¾æˆåè®®ï¼šå¸å¾’å¯’æœˆæ•™ä»–ã€Šä¹å¹½é­”å…¸ã€‹ï¼Œæ—ç¾½å¸®å¥¹æ¢å¤ä¿®ä¸º
- å›åˆ°å®—é—¨ï¼Œæ—ç¾½å‘ç°é™·å®³ä»–çš„æ˜¯è«å‡¡
- å¼€å§‹ç§˜å¯†ä¿®ç‚¼é­”é“åŠŸæ³•ï¼ŒåŒæ—¶éšè—å®åŠ›

ç¬¬äºŒå¹• - å´›èµ·ï¼ˆ6-15ç« ï¼‰
- æ—ç¾½ä¿®ä¸ºçªç ´ç­‘åŸºæœŸï¼Œéœ‡æƒŠå®—é—¨
- å‚åŠ å®—é—¨å¤§æ¯”ï¼Œå‡»è´¥æ¬ºå‡Œè€…ï¼Œåå£°é¹Šèµ·
- å¸å¾’å¯’æœˆæ¢å¤éƒ¨åˆ†ä¿®ä¸ºï¼Œæš—ä¸­å¸®åŠ©æ—ç¾½
- æ—ç¾½å‘ç°è‹æ¸…æ­Œè¢«é­”æ•™æ³èµ°ï¼Œå†³å®šè¥æ•‘
- æ·±å…¥é­”æ•™æ€»éƒ¨ï¼Œå‘ç°é­”æ•™å¹¶éæƒ³è±¡ä¸­é‚ªæ¶
- æ­éœ²è«å‡¡æ˜¯å†…é¬¼ï¼Œå‘ç°å¤©ç„å®—é«˜å±‚ä¸é­”æ•™å‹¾ç»“
- å¸å¾’å¯’æœˆå‘æ—ç¾½å¦ç™½ï¼šå¥¹ä½“å†…å°å°ç€ä»–å‰ä¸–ä¸€åŠçš„åŠ›é‡

ç¬¬ä¸‰å¹• - çœŸç›¸ï¼ˆ16-25ç« ï¼‰
- æ—ç¾½å’Œå¸å¾’å¯’æœˆæ¸¸å†ä¿®çœŸç•Œï¼Œå¯»æ‰¾å‰ä¸–çº¿ç´¢
- å‘ç°ä¸‰åƒå¹´å‰çš„æ­£é­”å¤§æˆ˜æ˜¯ä¸€åœºé˜´è°‹
- å„å¤§æ­£é“å®—é—¨è”æ‰‹å°å°é­”å°Šï¼Œæ˜¯ä¸ºäº†å¤ºå–"æˆä»™ä¹‹ç§˜"
- æ—ç¾½ä¿®ä¸ºçªç ´å…ƒå©´æœŸï¼Œå¸å¼•å„æ–¹åŠ¿åŠ›è¿½æ€
- å¸å¾’å¯’æœˆä¸ºä¿æŠ¤æ—ç¾½å—é‡ä¼¤ï¼Œè§£é™¤ä½“å†…å°å°
- æ—ç¾½æ¢å¤å‰ä¸–éƒ¨åˆ†åŠ›é‡ï¼Œä½†å‘ç°åŠ›é‡ä¸­è•´å«çš„è®°å¿†
- çœŸç›¸ï¼šå¸å¾’å¯’æœˆå‰ä¸–æ˜¯ä»–çš„é“ä¾£ï¼Œä¸ºäº†æ•‘ä»–ç”˜æ„¿æˆä¸ºå°å°

ç¬¬å››å¹• - æŠ‰æ‹©ï¼ˆ26-30ç« ï¼‰
- æ—ç¾½çªç ´åŒ–ç¥æœŸï¼Œæ­£å¼æ¢å¤é­”å°Šèº«ä»½
- æ­£é­”ä¸¤é“åŒæ—¶è§†ä»–ä¸ºå¨èƒ
- æ­éœ²"æˆä»™ä¹‹ç§˜"çœŸç›¸ï¼šéœ€è¦èåˆæ­£é­”ä¹‹åŠ›
- ç„æœºçœŸäººæš´éœ²çœŸé¢ç›®ï¼ŒåŸæ˜¯è¿œå¤é­”ç¥åˆ†èº«
- æ—ç¾½ä¸å¸å¾’å¯’æœˆè”æ‰‹å¯¹æŠ—çœŸæ­£çš„æ•Œäºº
- ç‰ºç‰²ä¸æˆé•¿ï¼šä¸ºäº†æ‹¯æ•‘ä¿®çœŸç•Œï¼Œå¿…é¡»æ”¾ä¸‹å‰ä¸–æ‰§å¿µ
- ç»“å±€ï¼šå¼€å¯æ–°çš„ä¿®çœŸæ—¶ä»£ï¼Œæ­£é­”ä¸å†å¯¹ç«‹</pre>
                        </div>

                        <!-- World Building -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">ä¸–ç•Œè®¾å®š (World Building):</span>
                                <button type="button" onclick="copyToClipboard('worldbuilding-example-cn')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    å¤åˆ¶ (Copy)
                                </button>
                            </div>
                            <pre id="worldbuilding-example-cn" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">ä¿®ä¸ºå¢ƒç•Œï¼š
1. ç‚¼æ°”æœŸï¼ˆ1-12å±‚ï¼‰
2. ç­‘åŸºæœŸï¼ˆåˆ/ä¸­/åæœŸï¼‰
3. é‡‘ä¸¹æœŸï¼ˆåˆ/ä¸­/åæœŸï¼‰
4. å…ƒå©´æœŸï¼ˆåˆ/ä¸­/åæœŸï¼‰
5. åŒ–ç¥æœŸï¼ˆåˆ/ä¸­/åæœŸï¼‰
6. æ¸¡åŠ«æœŸ
7. å¤§ä¹˜æœŸ
8. ä»™äºº

ä¸»è¦åŠ¿åŠ›ï¼š
æ­£é“ä¸‰å¤§å®—é—¨ï¼š
- å¤©ç„å®—ï¼šæœ€å¼ºæ­£é“å®—é—¨ï¼Œä»¥å‰‘ä¿®ä¸ºä¸»
- çµéœ„æ´¾ï¼šæ“…é•¿é˜µæ³•å’Œç‚¼å™¨
- å¤©æœºé˜ï¼šä»¥æ¨æ¼”å¤©æœºã€ç‚¼ä¸¹é—»å

é­”é“åŠ¿åŠ›ï¼š
- å¹½å†¥é­”æ•™ï¼šæœ€å¤§é­”é“ç»„ç»‡ï¼Œä¿®ç‚¼é­”åŠŸ
- è¡€ç…æ®¿ï¼šæ—ç¾½å‰ä¸–åˆ›ç«‹ï¼Œå·²è¦†ç­
- æ•£ä¿®é­”é“ï¼šä¸å±äºä»»ä½•ç»„ç»‡çš„é­”é“ä¿®å£«

é‡è¦åœ°ç‚¹ï¼š
- å¤©ç„å®—ï¼šä½äºäº‘éœ„å±±è„‰ï¼Œä»™æ°”ç¼­ç»•
- å¹½å†¥è°·ï¼šé­”æ•™æ€»éƒ¨ï¼Œç»ˆå¹´é»‘é›¾å¼¥æ¼«
- ç¦åœ°æ·±æ¸Šï¼šå°å°å¸å¾’å¯’æœˆä¹‹åœ°ï¼Œå±æœºé‡é‡
- ä¸Šå¤æˆ˜åœºï¼šä¸‰åƒå¹´å‰æ­£é­”å¤§æˆ˜é—è¿¹
- æˆä»™ä¹‹é—¨ï¼šä¼ è¯´ä¸­é€šå¾€ä»™ç•Œçš„é€šé“</pre>
                        </div>

                        <!-- Themes -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">ä¸»é¢˜ä¸åŸºè°ƒ (Themes & Tone):</span>
                                <button type="button" onclick="copyToClipboard('themes-example-cn')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    å¤åˆ¶ (Copy)
                                </button>
                            </div>
                            <pre id="themes-example-cn" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">æ ¸å¿ƒä¸»é¢˜ï¼š
- æ­£é‚ªå¯¹ç«‹çš„è™šå¦„ï¼šæ¢è®¨æ­£é“æœªå¿…æ­£ï¼Œé­”é“æœªå¿…é‚ª
- å‰ä¸–ä»Šç”Ÿçš„ç¾ç»Šï¼šæ—ç¾½ä¸å¸å¾’å¯’æœˆè·¨è¶Šä¸‰åƒå¹´çš„æƒ…æ„Ÿ
- å‘½è¿ä¸é€‰æ‹©ï¼šåºŸæé€†è¢­ï¼Œé çš„æ˜¯å®åŠ›è¿˜æ˜¯å‰ä¸–ç§¯ç´¯ï¼Ÿ
- æƒåŠ›çš„ä»£ä»·ï¼šè·å¾—åŠ›é‡å¿…é¡»ä»˜å‡ºä»€ä¹ˆï¼Ÿ
- èº«ä»½è®¤åŒï¼šä»–æ˜¯æ—ç¾½è¿˜æ˜¯è¡€ç…é­”å°Šï¼Ÿ

æ•…äº‹åŸºè°ƒï¼š
- å‰æœŸï¼šçƒ­è¡€çˆ½æ–‡ï¼ŒåºŸæé€†è¢­ï¼Œæ‰“è„¸è£…é€¼
- ä¸­æœŸï¼šé˜´è°‹è¯¡è®¡ï¼Œæ­éœ²çœŸç›¸ï¼Œæ­£é‚ªåšå¼ˆ
- åæœŸï¼šå²è¯—æˆ˜æ–—ï¼Œæƒ…æ„Ÿçº è‘›ï¼Œç»ˆææŠ‰æ‹©
- æ•´ä½“ï¼šæœ‰æ‰“æ–—æœ‰ç­–ç•¥ï¼Œæœ‰çƒ­è¡€æœ‰æƒ…æ„Ÿï¼Œæœ‰åè½¬æœ‰æˆé•¿</pre>
                        </div>

                        <!-- Writing Style -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900">å†™ä½œé£æ ¼ (Writing Style):</span>
                                <button type="button" onclick="copyToClipboard('style-example-cn')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 py-1 rounded">
                                    å¤åˆ¶ (Copy)
                                </button>
                            </div>
                            <pre id="style-example-cn" class="text-xs text-gray-700 bg-gray-50 p-3 rounded border border-gray-200 overflow-x-auto whitespace-pre-wrap">å™äº‹è§†è§’ï¼š
- ç¬¬ä¸‰äººç§°ï¼Œä»¥æ—ç¾½è§†è§’ä¸ºä¸»
- å…³é”®å‰§æƒ…åˆ‡æ¢åˆ°å¸å¾’å¯’æœˆæˆ–åæ´¾è§†è§’
- å‰ä¸–å›å¿†ç”¨ç¬¬ä¸€äººç§°ï¼Œå¢å¼ºä»£å…¥æ„Ÿ

èŠ‚å¥æ§åˆ¶ï¼š
- æ¯ç« 800-1200å­—ï¼Œé€‚åˆæ‰‹æœºé˜…è¯»
- å‰ä¸‰ç« å¿«é€Ÿå»ºç«‹ä¸–ç•Œè§‚å’Œå†²çª
- æ¯ç« ç»“å°¾ç•™æ‚¬å¿µæˆ–çˆ†ç‚¹
- æˆ˜æ–—åœºé¢è¯¦ç»†æå†™ï¼Œå¿ƒç†æ´»åŠ¨ç®€æ´æœ‰åŠ›
- æ¯5ç« ä¸€ä¸ªå°é«˜æ½®ï¼Œæ¯10ç« ä¸€ä¸ªå¤§è½¬æŠ˜

è¯­è¨€é£æ ¼ï¼š
- ä½¿ç”¨ä¿®çœŸå°è¯´å¸¸è§æœ¯è¯­ï¼ˆçµæ°”ã€æ³•å®ã€ç¥è¯†ç­‰ï¼‰
- å¯¹è¯ç®€æ´æœ‰åŠ›ï¼Œç¬¦åˆäººç‰©æ€§æ ¼
- é¿å…è¿‡åº¦ç™½è¯ï¼Œä¿æŒä¸€å®šå¤é£éŸµå‘³
- æˆ˜æ–—æå†™å¹²è„†åˆ©è½ï¼Œä¸æ‹–æ²“
- æƒ…æ„Ÿæˆå«è“„æ·±æ²‰ï¼Œä¸è¿‡åˆ†ç…½æƒ…

çˆ½ç‚¹è®¾è®¡ï¼š
- è£…é€¼æ‰“è„¸ï¼šåºŸæèº«ä»½ vs éšè—å®åŠ›
- è¶Šçº§æˆ˜æ–—ï¼šä»¥ä½å¢ƒç•Œå‡»è´¥é«˜å¢ƒç•Œ
- çº¢é¢œçŸ¥å·±ï¼šå¸å¾’å¯’æœˆã€è‹æ¸…æ­Œç­‰å¥³æ€§è§’è‰²çš„æƒ…æ„Ÿçº¿
- å®ç‰©è·å¾—ï¼šå¤è€ä¼ æ‰¿ã€é¡¶çº§æ³•å®
- èº«ä»½æ­ç§˜ï¼šé­”å°Šèº«ä»½æš´éœ²çš„éœ‡æ’¼
- å¤ä»‡çˆ½å¿«ï¼šæŠ¥å¤æ›¾ç»æ¬ºå‡Œè€…</pre>
                        </div>
                    </div>

                    <div class="mt-4 pt-4 border-t border-gray-200 flex items-center justify-between gap-4">
                        <p class="text-sm text-blue-900 flex-1">
                            <strong>ğŸ’¡ æç¤ºï¼š</strong> å¤åˆ¶ä¸Šé¢ä»»ä½•éƒ¨åˆ†å¹¶ç²˜è´´åˆ°ä¸‹é¢ç›¸åº”çš„å­—æ®µä¸­ï¼
                        </p>
                        <a href="/story/mo-zun-zhong-sheng/" target="_blank" class="text-sm bg-blue-100 hover:bg-blue-200 text-blue-800 font-medium px-4 py-2 rounded-lg transition whitespace-nowrap">
                            æŸ¥çœ‹å®Œæ•´æ•…äº‹ â†’
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <script>
            function toggleGuide() {
                const section = document.getElementById('guide-section');
                const chevron = document.getElementById('guide-chevron');

                if (section.classList.contains('hidden')) {
                    section.classList.remove('hidden');
                    chevron.classList.add('rotate-180');
                } else {
                    section.classList.add('hidden');
                    chevron.classList.remove('rotate-180');
                }
            }

            function switchExample(language) {
                // Toggle example sections
                const englishExample = document.getElementById('example-english');
                const chineseExample = document.getElementById('example-chinese');
                const englishTab = document.getElementById('tab-english');
                const chineseTab = document.getElementById('tab-chinese');

                if (language === 'english') {
                    // Show English, hide Chinese
                    englishExample.classList.remove('hidden');
                    chineseExample.classList.add('hidden');

                    // Update tab styles
                    englishTab.classList.add('bg-white', 'text-blue-800', 'border-blue-800');
                    englishTab.classList.remove('bg-blue-100', 'text-blue-700', 'border-transparent');
                    chineseTab.classList.add('bg-blue-100', 'text-blue-700', 'border-transparent');
                    chineseTab.classList.remove('bg-white', 'text-blue-800', 'border-blue-800');
                } else {
                    // Show Chinese, hide English
                    chineseExample.classList.remove('hidden');
                    englishExample.classList.add('hidden');

                    // Update tab styles
                    chineseTab.classList.add('bg-white', 'text-blue-800', 'border-blue-800');
                    chineseTab.classList.remove('bg-blue-100', 'text-blue-700', 'border-transparent');
                    englishTab.classList.add('bg-blue-100', 'text-blue-700', 'border-transparent');
                    englishTab.classList.remove('bg-white', 'text-blue-800', 'border-blue-800');
                }
            }

            function copyToClipboard(elementId) {
                const element = document.getElementById(elementId);
                const text = element.textContent;

                navigator.clipboard.writeText(text).then(() => {
                    // Show feedback
                    const btn = event.target;
                    const originalText = btn.textContent;
                    const isChinese = originalText.includes('å¤åˆ¶');
                    btn.textContent = isChinese ? 'å·²å¤åˆ¶ï¼' : 'Copied!';
                    btn.classList.add('bg-green-100', 'text-green-700');
                    btn.classList.remove('bg-gray-100', 'text-gray-700');

                    setTimeout(() => {
                        btn.textContent = originalText;
                        btn.classList.remove('bg-green-100', 'text-green-700');
                        btn.classList.add('bg-gray-100', 'text-gray-700');
                    }, 2000);
                });
            }
        </script>

        <form method="post" class="space-y-6">
            {% csrf_token %}

            <div>
                <label for="title" class="block text-sm font-medium text-gray-700 mb-2">
                    Story Title *
                </label>
                <input
                    type="text"
                    id="title"
                    name="title"
                    required
                    maxlength="200"
                    placeholder="The Quest for the Lost Kingdom"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                />
            </div>

            <div>
                <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                    Story Premise * (min 50 characters)
                </label>
                <textarea
                    id="description"
                    name="description"
                    rows="5"
                    required
                    minlength="50"
                    placeholder="Describe the world, main characters, and initial setup for your story..."
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                ></textarea>
                <p class="text-sm text-gray-500 mt-1">
                    This will guide the AI in generating your story chapters
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="genre" class="block text-sm font-medium text-gray-700 mb-2">
                        Genre
                    </label>
                    <select
                        id="genre"
                        name="genre"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                    >
                        {% for value, label in genre_choices %}
                            <option value="{{ value }}">{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div>
                    <label for="language" class="block text-sm font-medium text-gray-700 mb-2">
                        Language
                    </label>
                    <select
                        id="language"
                        name="language"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                    >
                        {% for value, label in language_choices %}
                            <option value="{{ value }}" {% if value == 'en' %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <!-- Cover Image Generation Section -->
            <div class="border border-gray-300 rounded-lg p-6 bg-gradient-to-r from-purple-50 to-pink-50">
                <div class="flex items-center gap-3 mb-4">
                    <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    <div>
                        <h3 class="font-bold text-gray-900">AI Cover Image</h3>
                        <p class="text-sm text-gray-600">Generate a professional cover using AI (powered by DALL-E 3)</p>
                    </div>
                </div>

                <!-- Custom Cover Description -->
                <div class="mb-4">
                    <label for="cover-description" class="block text-sm font-medium text-gray-700 mb-2">
                        Cover Image Description
                    </label>
                    <textarea
                        id="cover-description"
                        rows="3"
                        placeholder="Describe what you want on the cover (e.g., 'A warrior standing on a cliff overlooking a magical city at sunset')"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                    ></textarea>
                    <p class="text-xs text-gray-500 mt-1">
                        Describe the visual elements, scene, or atmosphere you want
                    </p>
                </div>

                <!-- Checkbox to use story details -->
                <div class="mb-4">
                    <label class="flex items-start gap-3 cursor-pointer">
                        <input
                            type="checkbox"
                            id="use-story-details"
                            onchange="toggleCoverDescriptionMode()"
                            class="mt-1 w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"
                        >
                        <div class="flex-1">
                            <span class="text-sm font-medium text-gray-700">Use full story details instead</span>
                            <p class="text-xs text-gray-500 mt-1">
                                Generate cover using all story framework fields (characters, world building, themes). More detailed but less control over specific visuals.
                            </p>
                        </div>
                    </label>
                </div>

                <div id="cover-preview-container" class="hidden mb-4">
                    <img id="cover-preview" src="" alt="Generated cover" class="w-full max-w-md mx-auto rounded-lg shadow-lg border-4 border-white">
                    <input type="hidden" id="cover-image-url" name="cover_image_url">
                </div>

                <div id="cover-error" class="hidden mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm"></div>

                <button
                    type="button"
                    id="generate-cover-btn"
                    onclick="generateCover()"
                    class="w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold px-6 py-3 rounded-lg transition flex items-center justify-center gap-2"
                >
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"></path>
                    </svg>
                    <span id="generate-cover-text">Generate AI Cover Image</span>
                </button>

                <p class="text-xs text-gray-600 mt-2 text-center">
                    Fill in title first â€¢ Free with your account
                </p>
                <p id="attempts-info" class="text-xs text-gray-500 mt-1 text-center hidden">
                    <span id="attempts-remaining"></span> regeneration(s) remaining for this story
                </p>
            </div>

            <script>
                function toggleCoverDescriptionMode() {
                    const checkbox = document.getElementById('use-story-details');
                    const textarea = document.getElementById('cover-description');

                    if (checkbox.checked) {
                        // Gray out and disable the textarea
                        textarea.disabled = true;
                        textarea.classList.add('bg-gray-100', 'text-gray-500', 'cursor-not-allowed');
                    } else {
                        // Enable the textarea
                        textarea.disabled = false;
                        textarea.classList.remove('bg-gray-100', 'text-gray-500', 'cursor-not-allowed');
                    }
                }

                async function generateCover() {
                    const title = document.getElementById('title').value.trim();
                    const genre = document.getElementById('genre').value;
                    const useStoryDetails = document.getElementById('use-story-details').checked;
                    const customDescription = document.getElementById('cover-description').value.trim();

                    // Validate inputs
                    if (!title) {
                        showCoverError('Please enter a story title first');
                        return;
                    }

                    // Build request body based on mode
                    let requestBody = {
                        title: title,
                        genre: genre,
                    };

                    if (useStoryDetails) {
                        // Use full story details mode
                        const description = document.getElementById('description').value.trim();
                        const characters = document.getElementById('characters')?.value.trim() || '';
                        const world_building = document.getElementById('world_building')?.value.trim() || '';
                        const themes = document.getElementById('themes')?.value.trim() || '';

                        if (!description || description.length < 50) {
                            showCoverError('Please enter a story description (at least 50 characters) first');
                            return;
                        }

                        requestBody.description = description;
                        requestBody.characters = characters;
                        requestBody.world_building = world_building;
                        requestBody.themes = themes;
                    } else {
                        // Use custom description mode
                        if (!customDescription || customDescription.length < 20) {
                            showCoverError('Please enter a cover description (at least 20 characters)');
                            return;
                        }

                        requestBody.custom_description = customDescription;
                    }

                    // Show loading state
                    const btn = document.getElementById('generate-cover-btn');
                    const btnText = document.getElementById('generate-cover-text');

                    btn.disabled = true;
                    btn.classList.add('opacity-75', 'cursor-not-allowed');
                    btnText.textContent = 'Generating cover image...';

                    // Hide any previous errors
                    document.getElementById('cover-error').classList.add('hidden');

                    try {
                        // Get CSRF token
                        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;

                        // Make API request
                        const response = await fetch('{% url "stories:generate_cover_image" %}', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded',
                                'X-CSRFToken': csrftoken,
                            },
                            body: new URLSearchParams(requestBody),
                        });

                        const data = await response.json();

                        if (data.success) {
                            // Show the generated image
                            document.getElementById('cover-preview').src = data.image_url;
                            document.getElementById('cover-image-url').value = data.image_url;
                            document.getElementById('cover-preview-container').classList.remove('hidden');

                            // Update button
                            btnText.textContent = 'Regenerate Cover Image';

                            // Show remaining attempts
                            updateAttemptsDisplay(data.attempts_remaining);

                            // Show success message (optional)
                            showCoverSuccess(data.message || 'Cover generated successfully!');
                        } else {
                            showCoverError(data.error || 'Failed to generate cover image');

                            // Update attempts display even on error
                            if (typeof data.attempts_remaining !== 'undefined') {
                                updateAttemptsDisplay(data.attempts_remaining);

                                // Disable button if no attempts left
                                if (data.attempts_remaining === 0) {
                                    btn.disabled = true;
                                    btnText.textContent = 'Generation Limit Reached';
                                }
                            }
                        }
                    } catch (error) {
                        console.error('Error:', error);
                        showCoverError('Network error. Please try again.');
                    } finally {
                        // Reset button state
                        btn.disabled = false;
                        btn.classList.remove('opacity-75', 'cursor-not-allowed');
                    }
                }

                function showCoverError(message) {
                    const errorDiv = document.getElementById('cover-error');
                    errorDiv.textContent = message;
                    errorDiv.classList.remove('hidden');
                }

                function showCoverSuccess(message) {
                    // You can add a success message display if desired
                    console.log('Success:', message);
                }

                function updateAttemptsDisplay(attemptsRemaining) {
                    const attemptsInfo = document.getElementById('attempts-info');
                    const attemptsSpan = document.getElementById('attempts-remaining');

                    if (typeof attemptsRemaining !== 'undefined' && attemptsRemaining >= 0) {
                        attemptsSpan.textContent = attemptsRemaining;
                        attemptsInfo.classList.remove('hidden');

                        // Change color based on remaining attempts
                        if (attemptsRemaining === 0) {
                            attemptsInfo.classList.remove('text-gray-500', 'text-yellow-600');
                            attemptsInfo.classList.add('text-red-600', 'font-semibold');
                        } else if (attemptsRemaining === 1) {
                            attemptsInfo.classList.remove('text-gray-500', 'text-red-600');
                            attemptsInfo.classList.add('text-yellow-600', 'font-semibold');
                        } else {
                            attemptsInfo.classList.remove('text-yellow-600', 'text-red-600', 'font-semibold');
                            attemptsInfo.classList.add('text-gray-500');
                        }
                    }
                }
            </script>

            <!-- Story Framework Section (Optional but Recommended) -->
            <div class="border border-gray-300 rounded-lg">
                <button
                    type="button"
                    onclick="toggleFramework()"
                    class="w-full flex items-center justify-between px-6 py-4 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-t-lg hover:from-purple-100 hover:to-indigo-100 transition"
                >
                    <div class="flex items-center gap-3">
                        <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <div class="text-left">
                            <h3 class="font-bold text-gray-900">Story Framework (Optional but Recommended)</h3>
                            <p class="text-sm text-gray-600">Help AI maintain consistency across chapters</p>
                        </div>
                    </div>
                    <svg id="framework-chevron" class="w-5 h-5 text-gray-500 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>

                <div id="framework-section" class="hidden px-6 pb-6 pt-4 space-y-6 bg-gray-50 rounded-b-lg">
                    <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4">
                        <p class="text-sm text-amber-900">
                            <strong>Why use a Story Framework?</strong> The AI will use these details as context when generating each chapter, ensuring character names, traits, world rules, and plot remain consistent throughout your story.
                        </p>
                    </div>

                    <div>
                        <label for="characters" class="block text-sm font-medium text-gray-700 mb-2">
                            Main Characters
                        </label>
                        <textarea
                            id="characters"
                            name="characters"
                            rows="6"
                            placeholder="Aria Ironforge (protagonist): 19-year-old blacksmith, brave but inexperienced, orphaned at age 5, skilled craftsman, stubborn. Dreams of adventure beyond her village.

Master Torin: Elderly blacksmith mentor, 68 years old, knows Aria's secret heritage, protective father figure.

Prince Kael: Reluctant ally, 24, heir to the Northern Kingdom, duty-bound but compassionate, skilled swordsman."
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm"
                        ></textarea>
                        <p class="text-sm text-gray-500 mt-1">
                            List main characters with names, ages, personalities, skills, and character arcs
                        </p>
                    </div>

                    <div>
                        <label for="story_outline" class="block text-sm font-medium text-gray-700 mb-2">
                            Story Outline / Plot Structure
                        </label>
                        <textarea
                            id="story_outline"
                            name="story_outline"
                            rows="8"
                            placeholder="Act 1: Discovery (Chapters 1-5)
- Aria finds dragon egg in her forge
- Learns about her true heritage from Master Torin
- Village attacked by Shadow Council, forced to flee

Act 2: Journey (Chapters 6-15)
- Travel through the five kingdoms seeking allies
- Meet Prince Kael, reluctant partnership forms
- Learn dragon magic, egg begins to hatch
- Discover Shadow Council's true motives

Act 3: Confrontation (Chapters 16-20)
- Final battle with Shadow Council
- Aria's dragon hatches, first flight
- Restore balance to the realm
- Aria accepts her role as Dragon Heir"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm"
                        ></textarea>
                        <p class="text-sm text-gray-500 mt-1">
                            Outline your story's major plot points, acts, and planned story arc
                        </p>
                    </div>

                    <div>
                        <label for="world_building" class="block text-sm font-medium text-gray-700 mb-2">
                            World Building & Setting
                        </label>
                        <textarea
                            id="world_building"
                            name="world_building"
                            rows="6"
                            placeholder="Setting: Medieval fantasy world, five kingdoms (North: icy mountains, South: desert plains, East: ancient forests, West: coastal cities, Central: volcanic highlands)

Magic System: Dragon-bonded magic - only those with dragon blood can wield elemental powers. Magic is rare, feared by common folk.

Technology: Medieval level with minor magic enhancements. No gunpowder. Blacksmiths are highly respected.

History: Dragons vanished 100 years ago during The Great Silence. Reason unknown. Most believe dragons are extinct.

Society: Monarchies rule each kingdom. Blacksmiths' Guild holds political power."
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm"
                        ></textarea>
                        <p class="text-sm text-gray-500 mt-1">
                            Describe your world's setting, magic system, technology level, and important rules
                        </p>
                    </div>

                    <div>
                        <label for="themes" class="block text-sm font-medium text-gray-700 mb-2">
                            Themes & Tone
                        </label>
                        <textarea
                            id="themes"
                            name="themes"
                            rows="4"
                            placeholder="Themes: Coming of age, finding your true identity, responsibility vs. freedom, balance between power and wisdom

Tone: Epic fantasy with personal stakes, moments of humor to balance intensity, focus on character growth over action, hopeful despite challenges"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm"
                        ></textarea>
                        <p class="text-sm text-gray-500 mt-1">
                            What themes does your story explore? What's the overall tone and mood?
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="planned_chapters" class="block text-sm font-medium text-gray-700 mb-2">
                                Planned Total Chapters
                            </label>
                            <input
                                type="number"
                                id="planned_chapters"
                                name="planned_chapters"
                                min="1"
                                max="200"
                                placeholder="20"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                            >
                            <p class="text-sm text-gray-500 mt-1">
                                Estimated total chapters (can be adjusted later)
                            </p>
                        </div>

                        <div>
                            <label for="writing_style_notes" class="block text-sm font-medium text-gray-700 mb-2">
                                Writing Style Preferences
                            </label>
                            <textarea
                                id="writing_style_notes"
                                name="writing_style_notes"
                                rows="3"
                                placeholder="Third-person limited (Aria's POV), descriptive but accessible prose, balance action with introspection, end chapters with hooks"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm"
                            ></textarea>
                            <p class="text-sm text-gray-500 mt-1">
                                POV, narrative style, pacing preferences
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                function toggleFramework() {
                    const section = document.getElementById('framework-section');
                    const chevron = document.getElementById('framework-chevron');

                    if (section.classList.contains('hidden')) {
                        section.classList.remove('hidden');
                        chevron.classList.add('rotate-180');
                    } else {
                        section.classList.add('hidden');
                        chevron.classList.remove('rotate-180');
                    }
                }
            </script>

            <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                <h3 class="font-semibold text-indigo-900 mb-2">About Personal Stories</h3>
                <ul class="text-sm text-indigo-800 space-y-1">
                    <li>â€¢ Your stories are private - only you can see and edit them</li>
                    <li>â€¢ Write prompts for each chapter and let AI generate the content</li>
                    <li>â€¢ AI considers your story premise and previous chapters for consistency</li>
                    <li>â€¢ Edit and refine as you go to create your perfect story</li>
                </ul>
            </div>

            <div class="flex gap-4">
                <button type="submit" class="flex-1 bg-indigo-600 text-white font-semibold px-6 py-3 rounded-lg hover:bg-indigo-700 transition">
                    Create Story
                </button>
                <a href="{% url 'stories:my_stories' %}" class="px-6 py-3 text-gray-700 font-semibold hover:text-gray-900 transition">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
