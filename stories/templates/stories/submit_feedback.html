{% extends 'base.html' %}

{% block title %}Submit Feedback - PlotVote{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <div class="bg-white rounded-lg shadow-sm p-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Submit Feedback</h1>
        <p class="text-gray-600 mb-6">
            We'd love to hear from you! Report bugs, suggest features, or share your thoughts about PlotVote.
        </p>

        <form method="post" enctype="multipart/form-data" class="space-y-6">
            {% csrf_token %}

            <!-- Type Selection -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Type *
                </label>
                <select
                    name="type"
                    required
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                >
                    <option value="bug">Bug Report</option>
                    <option value="feature">Feature Request</option>
                    <option value="feedback" selected>General Feedback</option>
                    <option value="other">Other</option>
                </select>
            </div>

            <!-- Email (for non-authenticated users) -->
            {% if not user.is_authenticated %}
            <div>
                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                    Your Email (Optional)
                </label>
                <input
                    type="email"
                    id="email"
                    name="email"
                    placeholder="your.email@example.com"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                />
                <p class="text-sm text-gray-500 mt-1">We'll use this to follow up with you (optional)</p>
            </div>
            {% endif %}

            <!-- Subject -->
            <div>
                <label for="subject" class="block text-sm font-medium text-gray-700 mb-2">
                    Subject *
                </label>
                <input
                    type="text"
                    id="subject"
                    name="subject"
                    required
                    maxlength="200"
                    placeholder="Brief summary of your feedback"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                />
            </div>

            <!-- Description -->
            <div>
                <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                    Description *
                </label>
                <textarea
                    id="description"
                    name="description"
                    required
                    rows="8"
                    placeholder="Please provide as much detail as possible..."
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                ></textarea>
                <p class="text-sm text-gray-500 mt-1">
                    For bugs: What did you expect to happen? What actually happened? Steps to reproduce?
                </p>
            </div>

            <!-- Screenshot Upload -->
            <div>
                <label for="screenshot" class="block text-sm font-medium text-gray-700 mb-2">
                    Screenshot (Optional)
                </label>
                <div class="flex items-center gap-4">
                    <label class="cursor-pointer bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg border border-gray-300 transition">
                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                        Choose Image
                        <input
                            type="file"
                            id="screenshot"
                            name="screenshot"
                            accept="image/*"
                            class="hidden"
                            onchange="updateFileName(this)"
                        />
                    </label>
                    <span id="file-name" class="text-sm text-gray-500">No file chosen</span>
                </div>
                <p class="text-sm text-gray-500 mt-1">
                    Upload a screenshot to help us understand the issue better
                </p>
            </div>

            <!-- Submit Button -->
            <div class="flex gap-4">
                <button
                    type="submit"
                    class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-6 py-3 rounded-lg transition"
                >
                    Submit Feedback
                </button>
                <a
                    href="{% url 'stories:homepage' %}"
                    class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-6 py-3 rounded-lg transition"
                >
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<script>
    function updateFileName(input) {
        const fileName = input.files[0]?.name || 'No file chosen';
        document.getElementById('file-name').textContent = fileName;
    }
</script>
{% endblock %}
